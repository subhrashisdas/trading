<html>
  <head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/mvp.css" />
    <script type="text/javascript">
      google.charts.load("current", { packages: ["corechart"] });

      function convertCandleToChartCandleFormat(candle) {
        return [new Date(candle.timestamp).toLocaleString(), candle.low, candle.open, candle.close, candle.high];
      }

      function drawChart(id, viewerData) {
        google.charts.setOnLoadCallback(function () {
          const data = google.visualization.arrayToDataTable(viewerData.map(convertCandleToChartCandleFormat), true);
          const chart = new google.visualization.CandlestickChart(document.getElementById(id));

          chart.draw(data, {
            legend: "none",
          });
        });
      }

      function drawAllChart(event) {
        event.preventDefault();
        console.log(event.target.elements.data.value)
        const allViewerData = JSON.parse(event.target.elements.data.value);
        console.log(allViewerData.fifteenMinutesCandles)
        drawChart("chart_div_15min", allViewerData.fifteenMinutesCandles);
        drawChart("chart_div_daily", allViewerData.dailyCandles);
        drawChart("chart_div_weekly", allViewerData.weeklyCandles);
        drawChart("chart_div_monthly", allViewerData.monthlyCandles);

        drawChart("chart_div_15min_trend", [allViewerData.fifteenMinutesTrendCandle]);
        drawChart("chart_div_daily_trend", [allViewerData.dailyTrendCandle]);
        drawChart("chart_div_weekly_trend", [allViewerData.weeklyTrendCandle]);
        drawChart("chart_div_monthly_trend", [allViewerData.monthlyTrendCandle]);
      }
    </script>
  </head>
  <body>
    <section>
      <form onsubmit="drawAllChart(event)">
        <input type="text" id="data" name="data" />
        <input type="submit" />
      </form>
    </section>
    <section>
      <header><h2>Fifteen Minutes Candle</h2></header>
      <div id="chart_div_15min" style="width: 900px; height: 500px"></div>
    </section>
    <section>
        <header><h2>Fifteen Minutes Trend</h2></header>
        <div id="chart_div_15min_trend" style="width: 900px; height: 500px"></div>
    </section>

    <section>
      <header><h2>Daily Candle</h2></header>
      <div id="chart_div_daily" style="width: 900px; height: 500px"></div>
    </section>
    <section>
        <header><h2>Daily Trend</h2></header>
        <div id="chart_div_daily_trend" style="width: 900px; height: 500px"></div>
    </section>

    <section>
      <header><h2>Weekly Candle</h2></header>
      <div id="chart_div_weekly" style="width: 900px; height: 500px"></div>
    </section>
    <section>
        <header><h2>Weekly Trend</h2></header>
        <div id="chart_div_weekly_trend" style="width: 900px; height: 500px"></div>
    </section>

    <section>
      <header><h2>Monthly Candle</h2></header>
      <div id="chart_div_monthly" style="width: 900px; height: 500px"></div>
    </section>
    <section>
        <header><h2>Monthly Trend</h2></header>
        <div id="chart_div_monthly_trend" style="width: 900px; height: 500px"></div>
      </section>
  </body>
</html>
